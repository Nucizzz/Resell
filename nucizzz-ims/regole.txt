3) Ciclo di deploy manuale (d’ora in poi)

Ogni volta che fai modifiche e pushi su GitHub:

Entra nel VPS:

ssh deploy@84.46.245.46
cd /opt/nucizzz-ims


Aggiorna il codice:

git pull origin main   # o il branch che usi


Ricostruisci e riavvia:

docker compose build --no-cache
docker compose up -d


Verifica:

docker compose ps
docker compose logs -f caddy
docker compose logs -f backend
docker compose logs -f frontend


Pulisci vecchie immagini (saltuario):

docker system prune -f


URL di produzione:

App (frontend proxy + API): https://app.nucizzz.shop

Swagger API: https://app.nucizzz.shop/api/docs

(Se usi Adminer, impostalo per stare su 127.0.0.1:8080 nel docker-compose.yml per non esporlo pubblicamente.)


ssh root@84.46.245.46
PASSWD:Sharkshopify1

ssh deploy@84.46.245.46
PASSWD:Sharkshopify1


DA POWERSHELL:
cd "C:\Users\jnuci\OneDrive\Documenti\GitHub\Resell\nucizzz-ims"

Compress-Archive -Path * -DestinationPath project.zip -Force

scp project.zip deploy@84.46.245.46:/home/deploy/


ssh deploy@84.46.245.46
PASSWD:Sharkshopify1

# sul VPS come utente "deploy"
sudo mkdir -p /opt/nucizzz-ims
sudo chown -R deploy:deploy /opt/nucizzz-ims

mv ~/project.zip /opt/nucizzz-ims/
cd /opt/nucizzz-ims

# se unzip non c'è:
sudo apt-get update && sudo apt-get install -y unzip

unzip -o project.zip


# se non hai ancora il file .env nel server:
cp .env.example .env
# apri e imposta le variabili necessarie
nano .env


RIAVVIO 
# dentro /opt/nucizzz-ims
docker compose down -v
docker system prune -af
docker volume prune -f

docker compose up -d --build



VERIFICA 
docker compose ps
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f caddy

